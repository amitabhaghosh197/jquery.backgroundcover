(function(e,t,i){"use strict";var o={poll:true,destroy:i};var n=0;var r="webkit moz ms o".split(" ");var a=e.requestAnimationFrame;var s=e.cancelAnimationFrame;var c;for(var g=0;g<r.length;g++){if(a&&s){break}c=r[g];a=a||e[c+"RequestAnimationFrame"];s=s||e[c+"CancelAnimationFrame"]||e[c+"CancelRequestAnimationFrame"]}if(!a||!s){a=function(t,i){var o=(new Date).getTime();var r=Math.max(0,16-(o-n));var a=e.setTimeout(function(){t(o+r)},r);n=o+r;return a};s=function(t){e.clearTimeout(t)}}function l(){var e=new Image,i=t(e);i.css({position:"absolute",display:"block"});return i}function d(e){var i=t('<div style="position:absolute;z-index:-99999999;width:100%;height:100%;" class="background-cover-image"/>');i.append(e);return i}function u(e,t,i){var o,n,r,a,s,c,g,u,h,p,m,f;s=t.css("backgroundPositionX");c=t.css("backgroundPositionY");if(!c||!s){a=t.css("backgroundPosition").split(" ");s=a[0];c=a[1]}e.propX=g=parseInt(s,10)===100?"right":"left";e.propY=u=parseInt(c,10)===100?"bottom":"top";e.cPropX=h=g==="right"?"marginRight":"marginLeft";e.cPropY=p=u==="bottom"?"bottom":"top";e.centerX=m=parseInt(s,10)===50;e.centerY=f=parseInt(c,10)===50;e.inlineBg=t[0].style.backgroundImage==="";o=new RegExp('\\"',"gi");e.src=i?i:t.css("background-image").split(/(\(|\))/)[2].replace(o,"");e.img=l();e.img.css(g,0);e.img.css(u,0);e.img.load(function(){e.imgH=n=e.img.prop("height");e.imgW=r=e.img.prop("width");e.mode=n<r?"landscape":"portrait";e.img.addClass(e.mode);e.ratio=r/n;e.ready=true;t.trigger("coverresize")}).attr("src",e.src);t.addClass("background-cover").css({position:"relative",overflow:"hidden",backgroundImage:"none"});e.container=d(e.img);e.container.append(e.img);t.append(e.container)}function h(e){return e.width()/e.height()}function p(e){return e.destroy?" "+e.destroy:""}function m(i,o){var n=o.width(),r=o.height(),s=function(){var e=false,t=o.height(),c=o.width();if(t!==n||c!==r){e=true;n=t;r=c}if(e){o.trigger("coverresize")}if(o.parent().length){i.poll=a(s)}};if(i.options.poll){s()}if(!i.options.poll){i.noPoll=function(){if(!o.parent().length){i.destroy()}o.trigger("coverresize")};t(e).on("resize.backgroundcover orientationchange.backgroundcover",i.noPoll)}o.on("remove destroyed"+p(i.options),function(){i.destroy()});o.on("coverresize resize",function(){var e=h(o),t,n,r,a=i.container.height(),s=i.container.width(),c=0,g=0;if(i.mode==="landscape"){if(e<i.ratio){n=a;r=a*i.ratio}else{n=s/i.ratio;r=s}}if(i.mode==="portrait"){if(e>i.ratio){n=s/i.ratio;r=s}else{n=a;r=a*i.ratio}}g=i.centerX?0-Math.round((r-s)/2):0;c=i.centerY?0-Math.round((n-a)/2):0;t={height:Math.round(n),width:Math.round(r)};t[i.cPropX]=g;t[i.cPropY]=c;i.img.css(t)})}function f(i,o){i.off("coverresize resize orientationchange");i.off("remove destroyed"+p(o.options));if(!o.options.poll){t(e).off("resize.backgroundcover orientationchange.backgroundcover",o.noPoll)}}function v(e,t,i){this.options=i;this.element=e;this.ready=false;this.inlineBg=false;u(this,e,t);m(this,e)}v.prototype={destroy:function(){if(this.poll){s(this.poll)}f(this.element,this);if(this.inlineBg){this.element.css({backgroundImage:"url("+this.src+")"})}else{this.element.css("background-image","")}if(this.container.length){this.container.empty().remove()}}};t.fn.backgroundcover=function(e,i){var n=t.extend({},o,i||{});return this.each(function(i,o){var r=t(o);r.data("backgroundCover",new v(r,e,n))})}})(this,this.jQuery);